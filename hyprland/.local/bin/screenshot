#!/bin/bash

[[ -f ~/.config/user-dirs.dirs ]] && source ~/.config/user-dirs.dirs
OUTPUT_DIR="${XDG_PICTURES_DIR:-$HOME/Pictures}"

if [[ ! -d "$OUTPUT_DIR" ]]; then
  notify-send "Screenshot directory does not exist: $OUTPUT_DIR" -u critical -t 3000
  exit 1
fi

MODE=${1:-region}
OPTION=${2:-}

pkill slurp 2>/dev/null

if [[ "$OPTION" == "--clipboard" ]]; then
  hyprshot -m "$MODE" --raw | wl-copy
  notify-send "ðŸ“¸ Screenshot copied to clipboard" -t 2000
else
  hyprshot -m "$MODE" --raw |
    satty --filename - \
      --output-filename "$OUTPUT_DIR/screenshot-$(date +'%Y-%m-%d_%H-%M-%S').png" \
      --early-exit \
      --actions-on-enter save-to-clipboard \
      --copy-command 'wl-copy'
fi
